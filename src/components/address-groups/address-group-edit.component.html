
<div class="space-y-6">
  <!-- Breadcrumb and Title -->
  <div>
    <nav class="text-sm" aria-label="Breadcrumb">
      <ol class="list-none p-0 inline-flex">
        <li class="flex items-center">
          <a routerLink="/address-groups" class="text-gray-500 hover:text-gray-700">Address Groups</a>
          <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
        </li>
        <li>
          <span class="text-gray-700 font-medium">{{ group().id === 'new' ? 'Add Group' : 'Edit Group' }}</span>
        </li>
      </ol>
    </nav>
    <h1 class="text-3xl font-bold text-gray-800 mt-2">{{ pageTitle() }}</h1>
  </div>

  <!-- Tabs -->
  <div class="border-b border-gray-200">
    <nav class="-mb-px flex space-x-8" aria-label="Tabs">
      <button (click)="activeTab.set('general')" [class.border-blue-500]="activeTab() === 'general'" [class.text-blue-600]="activeTab() === 'general'" [class.border-transparent]="activeTab() !== 'general'" [class.text-gray-500]="activeTab() !== 'general'" [class.hover:text-gray-700]="activeTab() !== 'general'" [class.hover:border-gray-300]="activeTab() !== 'general'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">General</button>
      <button (click)="activeTab.set('members')" [class.border-blue-500]="activeTab() === 'members'" [class.text-blue-600]="activeTab() === 'members'" [class.border-transparent]="activeTab() !== 'members'" [class.text-gray-500]="activeTab() !== 'members'" [class.hover:text-gray-700]="activeTab() !== 'members'" [class.hover:border-gray-300]="activeTab() !== 'members'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Members</button>
      <button (click)="activeTab.set('usage')" [class.border-blue-500]="activeTab() === 'usage'" [class.text-blue-600]="activeTab() === 'usage'" [class.border-transparent]="activeTab() !== 'usage'" [class.text-gray-500]="activeTab() !== 'usage'" [class.hover:text-gray-700]="activeTab() !== 'usage'" [class.hover:border-gray-300]="activeTab() !== 'usage'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Usage</button>
    </nav>
  </div>

  <!-- Tab Content -->
  @if (activeTab() === 'general') {
    <div class="bg-white p-6 rounded-lg shadow-sm">
      <div class="space-y-4">
        <div>
          <label for="groupName" class="block text-sm font-medium text-gray-700">Name *</label>
          <input type="text" id="groupName" [(ngModel)]="group().name" class="mt-1 block w-full md:w-1/2 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
        </div>
        <div>
          <label for="description" class="block text-sm font-medium text-gray-700">Description / note</label>
          <textarea id="description" [(ngModel)]="group().description" rows="3" class="mt-1 block w-full md:w-1/2 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"></textarea>
        </div>
      </div>
    </div>
  }
  @if (activeTab() === 'members') {
    <div class="bg-white p-6 rounded-lg shadow-sm">
        <h3 class="text-lg font-medium leading-6 text-gray-900">Members</h3>
        <p class="mt-1 text-sm text-gray-500">Add or remove entries from this group.</p>
        
        <!-- Add new member -->
        <div class="mt-4 flex items-center gap-2">
            <select [(ngModel)]="newMemberType" class="block w-40 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                <option value="Domain">Domain</option>
                <option value="Email">Email</option>
                <option value="IP">IP</option>
                <option value="Subnet">Subnet</option>
            </select>
            <input type="text" [(ngModel)]="newMemberValue" (keydown.enter)="addMember()" placeholder="Enter value..." class="flex-grow block px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            <button (click)="addMember()" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Add</button>
        </div>
        
        <!-- Member list -->
        <div class="mt-6 border-t border-gray-200 pt-4">
            @if (group().members.length > 0) {
                <div class="flex flex-wrap gap-2">
                    @for (member of group().members; track $index) {
                        <span class="inline-flex items-center py-1 pl-2.5 pr-1 text-sm font-medium rounded-full"
                            [class.bg-blue-100]="member.type === 'Domain'" [class.text-blue-800]="member.type === 'Domain'"
                            [class.bg-green-100]="member.type === 'Email'" [class.text-green-800]="member.type === 'Email'"
                            [class.bg-yellow-100]="member.type === 'IP'" [class.text-yellow-800]="member.type === 'IP'"
                            [class.bg-purple-100]="member.type === 'Subnet'" [class.text-purple-800]="member.type === 'Subnet'">
                            {{ member.value }}
                            <button (click)="removeMember($index)" type="button" class="flex-shrink-0 ml-1.5 p-0.5 rounded-full inline-flex items-center justify-center text-current hover:bg-white/50 focus:outline-none">
                                <span class="sr-only">Remove</span>
                                <svg class="h-3 w-3" stroke="currentColor" fill="none" viewBox="0 0 8 8">
                                    <path stroke-linecap="round" stroke-width="1.5" d="M1 1l6 6m0-6L1 7" />
                                </svg>
                            </button>
                        </span>
                    }
                </div>
            } @else {
                <p class="text-sm text-gray-500">This group has no members yet.</p>
            }
        </div>
    </div>
  }
  @if (activeTab() === 'usage') {
    <div class="bg-white p-6 rounded-lg shadow-sm">
        <h3 class="text-lg font-medium leading-6 text-gray-900">Usage</h3>
        <p class="mt-1 text-sm text-gray-500">This group is used in the following rules. (Read-only)</p>
        <!-- Read-only usage table here -->
        <div class="mt-4 text-sm text-gray-600">Usage information would be displayed here.</div>
    </div>
  }
  
  <!-- Action Buttons -->
  <div class="flex justify-end space-x-3">
    <button (click)="router.navigate(['/address-groups'])" type="button" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
      Cancel
    </button>
    <button (click)="save()" type="button" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
      Save
    </button>
  </div>
</div>
