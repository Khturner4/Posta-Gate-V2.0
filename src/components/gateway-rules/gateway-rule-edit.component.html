
<div class="space-y-6">
  <!-- Breadcrumb and Title -->
  <div>
    <nav class="text-sm" aria-label="Breadcrumb">
      <ol class="list-none p-0 inline-flex">
        <li class="flex items-center">
          <a routerLink="/gateway-rules" class="text-gray-500 hover:text-gray-700">Gateway Rules</a>
          <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
        </li>
        <li>
          <span class="text-gray-700 font-medium">{{ rule().id === 'new' ? 'Add Rule' : 'Edit Rule' }}</span>
        </li>
      </ol>
    </nav>
    <h1 class="text-3xl font-bold text-gray-800 mt-2">{{ pageTitle() }}</h1>
  </div>

  <!-- Tabs -->
  <div class="border-b border-gray-200">
    <nav class="-mb-px flex space-x-8" aria-label="Tabs">
      <button (click)="activeTab.set('general')" [class.border-blue-500]="activeTab() === 'general'" [class.text-blue-600]="activeTab() === 'general'" [class.border-transparent]="activeTab() !== 'general'" [class.text-gray-500]="activeTab() !== 'general'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">General</button>
      <button (click)="activeTab.set('senders')" [class.border-blue-500]="activeTab() === 'senders'" [class.text-blue-600]="activeTab() === 'senders'" [class.border-transparent]="activeTab() !== 'senders'" [class.text-gray-500]="activeTab() !== 'senders'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Senders & Recipients</button>
      <button (click)="activeTab.set('content')" [class.border-blue-500]="activeTab() === 'content'" [class.text-blue-600]="activeTab() === 'content'" [class.border-transparent]="activeTab() !== 'content'" [class.text-gray-500]="activeTab() !== 'content'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Content & DLP</button>
      <button (click)="activeTab.set('action')" [class.border-blue-500]="activeTab() === 'action'" [class.text-blue-600]="activeTab() === 'action'" [class.border-transparent]="activeTab() !== 'action'" [class.text-gray-500]="activeTab() !== 'action'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Action</button>
      <button (click)="activeTab.set('advanced')" [class.border-blue-500]="activeTab() === 'advanced'" [class.text-blue-600]="activeTab() === 'advanced'" [class.border-transparent]="activeTab() !== 'advanced'" [class.text-gray-500]="activeTab() !== 'advanced'" class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Advanced</button>
    </nav>
  </div>
  
  <div class="bg-white p-6 rounded-lg shadow-sm">
  @switch (activeTab()) {
    @case ('general') {
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="ruleName" class="block text-sm font-medium text-gray-700">Name *</label>
          <input type="text" id="ruleName" [(ngModel)]="rule().name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
        </div>
        <div>
          <label for="priority" class="block text-sm font-medium text-gray-700">Priority</label>
          <input type="number" id="priority" [(ngModel)]="rule().priority" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
        </div>
        <div class="col-span-1 md:col-span-2">
            <label class="block text-sm font-medium text-gray-700">Direction</label>
            <fieldset class="mt-2">
                <div class="flex items-center space-x-4">
                  <div class="flex items-center"><input id="inbound" [(ngModel)]="rule().direction" value="Inbound" type="radio" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300"><label for="inbound" class="ml-2 block text-sm font-medium text-gray-700">Inbound</label></div>
                  <div class="flex items-center"><input id="outbound" [(ngModel)]="rule().direction" value="Outbound" type="radio" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300"><label for="outbound" class="ml-2 block text-sm font-medium text-gray-700">Outbound</label></div>
                  <div class="flex items-center"><input id="both" [(ngModel)]="rule().direction" value="Both" type="radio" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300"><label for="both" class="ml-2 block text-sm font-medium text-gray-700">Both</label></div>
                </div>
            </fieldset>
        </div>
      </div>
    }
    @case ('senders') {
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="from" class="block text-sm font-medium text-gray-700">From</label>
                <select id="from" multiple class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    @for(group of addressGroups(); track group.id) {
                        <option [value]="group.name">{{ group.name }}</option>
                    }
                </select>
                <p class="mt-1 text-xs text-gray-500">Select address groups. Leave empty for "Any sender".</p>
            </div>
            <div>
                <label for="to" class="block text-sm font-medium text-gray-700">To</label>
                <select id="to" multiple class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    @for(group of addressGroups(); track group.id) {
                        <option [value]="group.name">{{ group.name }}</option>
                    }
                </select>
                <p class="mt-1 text-xs text-gray-500">Select address groups. Leave empty for "Any recipient".</p>
            </div>
        </div>
    }
    @case ('content') {
        <p class="text-gray-600">Content & DLP filter selection would be here.</p>
    }
    @case ('action') {
        <p class="text-gray-600">Action selection would be here.</p>
    }
    @case ('advanced') {
        <p class="text-gray-600">Advanced options like "Stop processing" would be here.</p>
    }
  }
  </div>

  <div class="flex justify-end space-x-3">
    <button (click)="router.navigate(['/gateway-rules'])" type="button" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Cancel</button>
    <button (click)="save()" type="button" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Save</button>
  </div>
</div>
